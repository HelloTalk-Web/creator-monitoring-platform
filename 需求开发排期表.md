# 创作者数据监控平台 - 需求开发排期表

**项目名称**: Creator Monitoring Platform
**当前进度**: 65%
**文档最后更新**: 2025-10-15 18:30
**负责人**: 阿祖 (Cen-Yaozu)

---

## 📊 一、功能完成度总览

| 模块 | 完成度 | 状态 |
|------|--------|------|
| 基础架构 | 100% | ✅ 已完成 |
| TikTok 数据抓取 | 100% | ✅ 已完成 |
| YouTube 数据抓取 | 100% | ✅ 已完成 |
| 基础数据展示 | 100% | ✅ 已完成 |
| 标签过滤功能 | 100% | ✅ 已完成 |
| 热门视频功能 | 100% | ✅ 已完成 |
| Excel 导出功能 | 100% | ✅ 已完成 |
| 账号管理功能 | 100% | ✅ 已完成 |
| 批量导入功能 | 100% | ✅ 已完成 |
| 多平台支持 | 33% (2/6) | 🔄 进行中 |
| 自动刷新机制 | 0% | ❌ 未开始 |
| 历史数据追踪 | 60% | 🔄 进行中 |
| 高级数据看板 | 25% | 🔄 进行中 |
| 数据统计分析 | 0% | ❌ 未开始 |
| **总体进度** | **65%** | 🔄 进行中 |

---

## 📋 二、详细功能清单与排期

### **阶段一：基础功能完善 (Week 1-2, 预计 10 工作日)**

| 优先级 | 功能点 | 工作量 | 技术难度 | 依赖项 | 负责人 | 状态 |
|--------|--------|--------|----------|--------|--------|------|
| P0 | 1. 播放量 >10k 热门标识 + 快速过滤 | 0.5天 | ⭐ 简单 | 无 | 阿祖 | ✅ 已完成 |
| P0 | 2. Excel 导出功能 | 1-2天 | ⭐⭐ 中等 | 无 | 阿祖 | ✅ 已完成 |
| P0 | 3. 手动刷新按钮 | 1天 | ⭐ 简单 | 无 | 阿祖 | ✅ 已完成 |
| P0 | 4. 定时自动刷新机制 | 2-3天 | ⭐⭐ 中等 | 手动刷新 | 待分配 | ❌ 未开始 |
| P0 | 5. 视频历史数据追踪(24h/7天/14天/30天) | 3-4天 | ⭐⭐⭐ 困难 | 无 | 阿祖 | 🔄 进行中(60%) |

**阶段一产出**:
- ✅ 用户可以看到播放量超过10k的热门视频（已完成：热门徽章 + 快速过滤按钮）
- ✅ 支持导出Excel报表（已完成：支持当前筛选和全部数据导出）
- ⏳ 支持手动和自动刷新数据
- ⏳ 可以查看不同时间段的播放量增长

---

### **阶段二：多平台支持 (Week 3-4, 预计 10 工作日)**

| 优先级 | 功能点 | 工作量 | 技术难度 | 依赖项 | 负责人 | 状态 |
|--------|--------|--------|----------|--------|--------|------|
| P0 | 6. Instagram 爬虫适配器 | 3-5天 | ⭐⭐⭐⭐ 很困难 | API调研 | 待分配 | ❌ 未开始 |
| P0 | 7. YouTube 爬虫适配器 | 1天 | ⭐⭐⭐ 困难 | YouTube API Key | 阿祖 | ✅ 已完成 |
| P0 | 8. 批量导入账号功能 | 0.5天 | ⭐⭐ 中等 | 多平台爬虫 | 阿祖 | ✅ 已完成 |
| P0 | 9. 账号列表页面优化 | 1天 | ⭐⭐ 中等 | 无 | 阿祖 | ✅ 已完成 |
| P1 | 10. Facebook 爬虫适配器 (可选) | 3-5天 | ⭐⭐⭐⭐ 很困难 | API调研 | 待分配 | ⏸️ 暂缓 |
| P1 | 11. 抖音爬虫适配器 (可选) | 3-5天 | ⭐⭐⭐⭐ 很困难 | API调研 | 待分配 | ⏸️ 暂缓 |
| P1 | 12. 小红书爬虫适配器 (可选) | 3-5天 | ⭐⭐⭐⭐ 很困难 | API调研 | 待分配 | ⏸️ 暂缓 |

**阶段二产出**:
- ✅ 支持 Instagram 账号和视频数据抓取
- ✅ 支持 YouTube 账号和视频数据抓取
- ✅ 可以在同一平台查看所有平台的创作者数据

**技术风险**:
- Instagram Graph API 需要商业账号授权
- YouTube Data API 有每日配额限制
- 可能需要使用第三方爬虫服务（如 ScrapeCreators）

---

### **阶段三：功能增强 (Week 5-6, 预计 8 工作日)**

| 优先级 | 功能点 | 工作量 | 技术难度 | 依赖项 | 负责人 | 状态 |
|--------|--------|--------|----------|--------|--------|------|
| P1 | 11. 单条视频添加功能 | 1-2天 | ⭐⭐ 中等 | 无 | 待分配 | ❌ 未开始 |
| P1 | 12. 单条视频启用/暂停监测 | 1天 | ⭐ 简单 | 视频添加 | 待分配 | ❌ 未开始 |
| P1 | 13. 账号编辑(备注名) | 1天 | ⭐ 简单 | 无 | 待分配 | ❌ 未开始 |
| P1 | 14. 账号暂停/启用监测 | 1天 | ⭐ 简单 | 无 | 待分配 | ❌ 未开始 |
| P0 | 15. 视频卡片UI优化(显示分时段播放量) | 2天 | ⭐⭐ 中等 | 历史数据追踪 | 待分配 | ❌ 未开始 |

**阶段三产出**:
- ✅ 支持直接添加单条视频链接进行监控
- ✅ 可以暂停/启用特定视频或账号的监测
- ✅ 可以为账号添加备注名称
- ✅ 视频卡片展示更丰富的播放量数据

---

### **阶段四：数据分析与可视化 (Week 7-9, 预计 12 工作日)**

| 优先级 | 功能点 | 工作量 | 技术难度 | 依赖项 | 负责人 | 状态 |
|--------|--------|--------|----------|--------|--------|------|
| P1 | 16. 累计播放量统计 | 1天 | ⭐ 简单 | 无 | 待分配 | ❌ 未开始 |
| P1 | 17. 视频总数统计 | 0.5天 | ⭐ 简单 | 无 | 待分配 | ❌ 未开始 |
| P1 | 18. TOP 10 播放量视频 | 1天 | ⭐ 简单 | 无 | 待分配 | ❌ 未开始 |
| P1 | 19. 各平台视频数量分布饼图 | 1-2天 | ⭐⭐ 中等 | 图表库 | 待分配 | ❌ 未开始 |
| P1 | 20. 播放量随时间变化曲线图 | 2-3天 | ⭐⭐⭐ 困难 | 历史数据+图表库 | 待分配 | ❌ 未开始 |
| P1 | 21. 按周/月对比数据 | 2天 | ⭐⭐ 中等 | 历史数据 | 待分配 | ❌ 未开始 |
| P2 | 22. 视频详情页 | 2-3天 | ⭐⭐ 中等 | 曲线图 | 待分配 | ❌ 未开始 |
| P2 | 23. 自定义看板 | 5-7天 | ⭐⭐⭐⭐ 很困难 | 所有统计功能 | 待分配 | ⏸️ 暂缓 |

**阶段四产出**:
- ✅ 完整的数据统计看板
- ✅ 可视化图表展示
- ✅ 支持不同时间维度的数据对比
- ✅ 视频详情页展示详细数据

**技术方案**:
- 图表库: Chart.js 或 Recharts
- 数据源: videoMetricsHistory 表

---

### **阶段五：高级功能 (Week 10+, 可选)**

| 优先级 | 功能点 | 工作量 | 技术难度 | 依赖项 | 负责人 | 状态 |
|--------|--------|--------|----------|--------|--------|------|
| P2 | 24. 观看者粉丝画像 | N/A | ⭐⭐⭐⭐⭐ 极困难 | 平台授权 | 待分配 | ⚠️ 不可行 |
| P2 | 25. 数据导出PDF报告 | 3-5天 | ⭐⭐⭐ 困难 | 所有统计功能 | 待分配 | ⏸️ 暂缓 |
| P2 | 26. 邮件/钉钉报警通知 | 2-3天 | ⭐⭐ 中等 | 无 | 待分配 | ⏸️ 暂缓 |
| P2 | 27. 用户权限管理 | 3-5天 | ⭐⭐⭐ 困难 | 无 | 待分配 | ⏸️ 暂缓 |

**备注**:
- "观看者粉丝画像"功能几乎不可能实现，因为大部分平台不公开此类数据
- 其他功能为锦上添花，可根据实际需求决定是否开发

---

## 🗓️ 三、整体时间规划

```
阶段一: 基础功能完善          Week 1-2   (10 工作日)  ████████░░░░░░░░░░  52% (2.6/5完成)
阶段二: 多平台支持            Week 3-4   (10 工作日)  ░░░░░░░░░░░░░░░░░░   0%
阶段三: 功能增强              Week 5-6   ( 8 工作日)  ░░░░░░░░░░░░░░░░░░   0%
阶段四: 数据分析与可视化      Week 7-9   (12 工作日)  ░░░░░░░░░░░░░░░░░░   0%
阶段五: 高级功能 (可选)       Week 10+   (按需)      ░░░░░░░░░░░░░░░░░░   0%
```

**预计总工期**: 6-9 周 (约 1.5-2 个月)

---

## 🎯 四、里程碑计划

| 里程碑 | 完成标准 | 预计时间 | 状态 |
|--------|----------|----------|------|
| **M1: MVP 上线** | TikTok + 基础功能 | ✅ 已完成 | ✅ Done |
| **M2: 功能完善** | 刷新机制 + 历史数据 + 报警 + 导出 | Week 2 | ❌ 未开始 |
| **M3: 多平台支持** | Instagram + YouTube 适配器 | Week 4 | ❌ 未开始 |
| **M4: 功能增强** | 视频管理 + 账号管理 + UI优化 | Week 6 | ❌ 未开始 |
| **M5: 数据分析** | 统计看板 + 可视化图表 | Week 9 | ❌ 未开始 |

---

## 📌 五、关键技术决策

### 1. 多平台爬虫方案

| 平台 | 方案选择 | 成本 | 风险 | 状态 |
|------|----------|------|------|------|
| TikTok | ScrapeCreators API | 按量付费 | ✅ 已验证可行 | ✅ 已完成 |
| YouTube | YouTube Data API v3 | 免费(有配额) | ⚠️ 配额限制 | ✅ 已完成 |
| Instagram | 方案待定 (需调研) | 未知 | ⚠️ API限制较多 | ❌ 未开始 |
| 抖音 | 方案待定 | 未知 | ⚠️ 反爬严格 | ⏸️ 暂缓 |
| 小红书 | 方案待定 | 未知 | ⚠️ 反爬严格 | ⏸️ 暂缓 |
| Facebook | 方案待定 | 未知 | ⚠️ API限制 | ⏸️ 暂缓 |

**建议**: 优先完成 TikTok + Instagram + YouTube，其他平台视实际需求再扩展。

### 2. 定时任务方案

- **技术选型**: node-cron (已安装)
- **执行频率**: 每天凌晨 2:00 自动刷新
- **任务队列**: 使用简单的队列机制，避免并发过高导致API限流

### 3. 数据可视化方案

- **图表库**: Chart.js (轻量) 或 Recharts (React生态)
- **数据源**: videoMetricsHistory 表 (历史快照数据)

---

## ⚠️ 六、风险与挑战

| 风险项 | 影响 | 概率 | 应对方案 |
|--------|------|------|----------|
| Instagram API 授权困难 | 高 | 高 | 寻找第三方爬虫服务 |
| YouTube API 配额不足 | 中 | 中 | 申请配额增加或付费升级 |
| 定时任务并发导致限流 | 中 | 中 | 实现任务队列和限流机制 |
| 历史数据存储成本 | 低 | 低 | 定期清理过期数据 |
| 平台反爬机制升级 | 高 | 中 | 持续监控，及时调整策略 |

---

## 📝 七、测试账号信息

### Dansukiii
- **TikTok**: https://www.tiktok.com/@dansukiii
- **Instagram**: https://www.instagram.com/_dansukiii/
- **YouTube**: https://www.youtube.com/@dansukiii/shorts

### Kanakura Sora
- **TikTok**: https://www.tiktok.com/@kanakurasora
- **YouTube**: https://www.youtube.com/@kanakurasora
- **Instagram**: https://www.instagram.com/kanakurasora

### 合作标签 (不区分大小写)
- #HelloTalk
- #talktoforeigner / #talktoforeigners
- #HelloTalkFriend / #HelloTalkFriends
- #languagepartner / #languagepartners

---

## 📊 八、下一步行动建议

**本周重点** (Week 1):
1. ✅ 实现播放量 >10k 热门标识 + 快速过滤（已完成 2025-10-15）
2. ✅ 开发 Excel 导出功能（已完成 2025-10-15）
3. ⏳ 添加手动刷新按钮

**下周重点** (Week 2):
4. ⏳ 添加手动刷新按钮
5. ⏳ 实现定时自动刷新
6. ⏳ 开发视频历史数据追踪
7. ⏳ 视频卡片UI优化

**本月目标** (Month 1):
- 完成阶段一和阶段二
- TikTok + Instagram + YouTube 三平台全面支持

---

## 📞 联系信息

- **项目负责人**: 阿祖 (Cen-Yaozu)
- **组织**: HelloTalk-Web
- **项目仓库**: https://github.com/HelloTalk-Web/creator-monitoring-platform

---

---

## 📅 九、更新日志

### 2025-10-15 18:30
- ✅ **完成功能**: YouTube 爬虫适配器
  - 使用 YouTube Data API v3 实现完整的数据抓取
  - 支持频道信息获取（@handle 和 /channel/ID 格式）
  - 支持视频列表抓取（默认50个最新视频）
  - 支持单个视频信息查询
  - 数据转换为统一格式,与 TikTok 格式兼容
  - 添加视频 URL 错误处理,拒绝视频链接并提示用户使用频道链接
- ✅ **完成功能**: 批量导入账号
  - 在"添加账号"对话框中新增"批量导入"标签页
  - 支持一次性粘贴多个账号 URL（每行一个）
  - 支持 TikTok、YouTube、抖音等多平台混合导入
  - 实时显示导入进度和结果
  - 逐条导入并显示成功/失败状态和详细信息
- ✅ **完成功能**: 账号列表页面优化
  - 从卡片网格改为表格视图,展示更多信息
  - 添加分页功能（每页20条记录）
  - 添加平台筛选下拉框（全部/TikTok/YouTube/抖音/小红书）
  - 添加账号名称搜索功能
  - 优化积分显示位置（集成到页面标题区域,不再单独显示卡片）
  - 表格列包含: ID、账号信息（头像+名称+简介）、平台、粉丝数、视频数、最后同步时间、操作按钮
- 🔧 **Bug修复**:
  - 修复 YouTube Shorts URL 被识别为无效的问题（现在会明确提示用户使用频道链接）
  - 修复后端分页数据结构不匹配问题（pagination.total）
  - 修复平台筛选和搜索功能的前后端参数名不一致问题
- 🏗️ **技术改进**:
  - YouTube 适配器实现 ISO 8601 时长解析
  - YouTube 适配器支持频道 customUrl 处理（自动移除@符号）
  - 后端 Controller 层支持 `platformName` 和 `displayName` 参数
  - 后端 Service 层添加 displayName 模糊查询
  - 前端添加 shadcn/ui Select 组件
  - API 响应正确返回 pagination 对象
- 📊 **进度更新**:
  - YouTube 数据抓取: 0% → 100%
  - 基础数据展示: 85% → 100%
  - 账号管理功能: 0% → 100%
  - 批量导入功能: 0% → 100%
  - 多平台支持: 16% → 33%
  - 总体进度: 55% → 65%

### 2025-10-15 16:15
- ✅ **完成功能**: 视频历史数据追踪基础架构 (AOP模式)
  - 实现了基于TypeScript Decorator的AOP架构
  - 创建视频更新事件发射器 (`video.events.ts`)
  - 创建视频历史快照监听器 (`video-history.listener.ts`)
  - 实现 `@TrackVideoChanges()` 装饰器自动拦截视频更新
  - 爬虫代码完全解耦,不再主动触发历史快照保存
  - 监听器异步执行,带指数退避重试机制 (2s, 4s, 8s)
  - 自动检测指标变化,避免无意义的历史记录
- 🏗️ **架构改进**:
  - 采用真正的AOP(面向切面编程)架构
  - 业务代码与横切关注点完全分离
  - Decorator (装饰器) → Event Emitter (事件总线) → Listener (监听器)
  - 符合关注点分离原则,易于维护和扩展
- 📊 **数据模型**:
  - 已有 `video_metrics_history` 表存储历史快照
  - 服务层提供查询历史数据、趋势分析、最新指标等功能
  - 支持按时间段聚合 (24h/7d/14d/30d)
- 🔧 **技术细节**:
  - 启用 TypeScript 装饰器支持 (`experimentalDecorators: true`)
  - 使用 Node.js EventEmitter 作为事件总线
  - `setImmediate()` 确保事件异步发射,不阻塞主业务
- ✅ **测试验证**: 已通过实际爬虫测试,历史快照自动保存成功
- 📊 **进度更新**:
  - 历史数据追踪: 0% → 60% (基础架构完成,待前端UI)
  - 总体进度: 50% → 55%

### 2025-10-15 14:30
- ✅ **完成功能**: Excel 导出功能
  - 实现导出当前筛选结果为Excel
  - 实现导出全部视频数据为Excel
  - 导出内容包含：视频标题、创作者、平台、发布时间、各项数据指标、标签、视频链接等
  - 添加 page_url 字段存储TikTok视频页面URL
  - 修复导出功能中创作者和平台信息缺失问题
  - 移除重复的视频描述列（TikTok特性：title和description相同）
- 🔧 **技术改进**:
  - 数据库新增 page_url 字段
  - video.service 使用 JOIN 查询关联创作者和平台信息
  - 爬虫自动提取并保存视频页面URL
  - 回填了40条历史数据的 page_url
- 📊 **进度更新**: 总体进度从 45% → 50%

### 2025-10-15 15:10
- ✅ **完成功能**: 播放量 >10k 热门标识 + 快速过滤
  - 实现热门视频徽章（🔥图标）
  - 添加"只看热门"快速过滤按钮
  - 移除了刺眼的红色边框，采用更优雅的设计
- 📊 **进度更新**: 总体进度从 40% → 45%

---

*文档最后更新: 2025-10-15 18:30*
